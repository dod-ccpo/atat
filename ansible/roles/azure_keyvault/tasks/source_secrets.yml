- name: set var values fact
  set_fact:
    vars_vals: "{{ lookup('to_hcl', tf_base_dir+'/'+az_environment+'/'+az_environment+'.tfvars.json' ) | safe | string }}"
  when:
    - secrets_source == "tfvars"



- include: ../../bootstrap/tasks/show_outputs.yml


- name: get app _output
  include: ../../terraform/tasks/get_backend.yml

- include: ../../terraform/tasks/show_outputs.yml



- name: "show outputs of app_config_values"
  debug:
    msg:  " outputs are .. {{ tf_app_env_outputs.app_config_values.value }}"

- name: set var values fact
  set_fact:
    vars_vals: '{{ tf_app_env_outputs.app_config_values.value | safe | string |  regex_replace("''",''"'')  | from_json }}'
  when:
    - secrets_source == "tfoutputs"
    - top_level_secrets == true
